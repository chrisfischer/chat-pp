syntax = "proto3";

package client_server;


message TextMessage {
    string room = 1;
    string text = 2;
}

message NicknameMessage {
    string room = 1;
    string old_nickname = 2;
    string new_nickname = 3;
}

message LeftMessage {
    string room = 1;
    string nickname = 2;
}

message JoinMessage {
    string room = 1;
    string nickname = 2;
}

message VoteMessage {
    string room = 1;
    string vote_id = 2;
    bool vote = 3;
}

message VoteResultMessage {
    string room = 1;
    bool vote = 3;
    string message = 4;
    int64 total_number_users = 5;
}

message StartKickVoteMessage {
    string room = 1;
    string nickname = 2;
    string vote_id = 3;
}

message Message {
    oneof message_oneof {
        TextMessage text_message = 2;
        NicknameMessage nickname_message = 3;
        JoinMessage join_message = 4;
        LeftMessage left_message = 5;
        VoteMessage vote_message = 6;
        StartKickVoteMessage start_kick_vote_message = 7;
    }
}

message MessageResult {
    bool received = 1;
}

message Empty {}

service ChatService {
    rpc ReceiveMessages(Empty) returns (stream Message) {}
    rpc SendMessage(Message) returns (MessageResult) {}
}
